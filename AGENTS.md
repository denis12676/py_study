# Инструкции для AI агентов - Работа с WB API

## Обязательное использование Swagger спецификаций

При написании любых скриптов, интеграций или кода, связанного с Wildberries API, **ОБЯЗАТЕЛЬНО** обращаться к YAML спецификациям в папке `docs/swagger/`.

## Где находятся спецификации

Все спецификации находятся в:
```
docs/swagger/
```

## Список доступных спецификаций

| № | Файл | Описание раздела |
|---|------|------------------|
| 01 | `01-general.yaml` | Общая информация, авторизация, новости |
| 02 | `02-products.yaml` | Управление товарами |
| 03 | `03-orders-fbs.yaml` | Заказы FBS |
| 04 | `04-orders-dbw.yaml` | Заказы DBW |
| 05 | `05-orders-dbs.yaml` | Заказы DBS |
| 06 | `06-in-store-pickup.yaml` | Заказы с самовывоза |
| 07 | `07-orders-fbw.yaml` | Поставки FBW |
| 08 | `08-promotion.yaml` | Маркетинг и продвижение |
| 09 | `09-communications.yaml` | Общение с покупателями |
| 10 | `10-tariffs.yaml` | Тарифы и комиссии |
| 11 | `11-analytics.yaml` | Аналитика и данные |
| 12 | `12-reports.yaml` | Отчёты |
| 13 | `13-finances.yaml` | Документы и бухгалтерия |
| 14 | `14-wbd.yaml` | Wildberries Цифровой |

## Что нужно делать при написании кода

### 1. Перед началом работы
- Определить какой раздел API требуется
- Прочитать соответствующий YAML файл
- Изучить endpoints, параметры, схемы данных

### 2. Проверка endpoints
- Всегда сверяться с актуальными URL из спецификаций
- Проверять HTTP методы (GET, POST, PUT, DELETE, PATCH)
- Учитывать required параметры

### 3. Работа с моделями данных
- Использовать схемы (schemas) из YAML для:
  - Структур запросов (request bodies)
  - Структур ответов (response schemas)
  - Валидации данных
  - Типизации (для TypeScript/Python)

### 4. Примеры использования

**Чтение спецификации:**
```python
# Пример: получение информации о товарах
# Из 02-products.yaml - раздел "Карточки товаров"

# Правильно:
# GET /content/v2/cards/list - получение списка карточек
# POST /content/v2/cards/upload - создание карточек
```

**Создание клиента API:**
```python
# Всегда проверять базовый URL в спецификации
# Например, из 02-products.yaml:
# servers:
#   - url: https://content-api.wildberries.ru
```

## Важные замечания

1. **Не полагаться на память** - всегда перепроверять в YAML файлах
2. **Проверять версии** - все спецификации OpenAPI 3.0.x
3. **Учитывать лимиты** - rate limits указаны в спецификациях
4. **Валидировать данные** - использовать схемы для валидации
5. **Обрабатывать ошибки** - статус-коды и ошибки описаны в YAML

## Официальная документация

- URL: https://dev.wildberries.ru/
- Swagger UI: https://dev.wildberries.ru/swagger/general
- Формат: OpenAPI 3.0.x (YAML)

## Дата актуализации

Спецификации скачаны: **25.02.2026**

---

**ВАЖНО:** При любых изменениях кода, связанного с WB API, первым шагом должно быть чтение соответствующего YAML файла из `docs/swagger/`.

---

## Правила коммитов и публикации изменений

### Обязательный порядок действий после успешных изменений

После того как код успешно изменен и протестирован (включая успешное прохождение соответствующих тестов), **ОБЯЗАТЕЛЬНО** выполнить следующие шаги:

### 1. Проверка изменений
```bash
# Проверить какие файлы были изменены
git status

# Проверить содержимое изменений
git diff
```

### 2. Добавление файлов в коммит
```bash
# Добавить только нужные файлы (не включать временные файлы, кеш, скриншоты тестов)
git add <file1> <file2> ...

# Или использовать git add -p для интерактивного выбора изменений
```

**Что НЕЛЬЗЯ добавлять в коммит:**
- Временные файлы (cache, .pyc, логи)
- Скриншоты тестов (`tests/e2e/screenshots/`)
- Локальные конфигурации (.env с секретами)
- Бинарные файлы без необходимости

### 3. Создание коммита
```bash
# Использовать информативное сообщение коммита
# Формат: type(scope): description

git commit -m "feat: добавить новую функциональность X

- Описание изменения 1
- Описание изменения 2
- Исправлена проблема Y"
```

**Типы коммитов:**
- `feat:` - новая функциональность
- `fix:` - исправление ошибки
- `test:` - добавление тестов
- `refactor:` - рефакторинг без изменения функциональности
- `docs:` - обновление документации
- `chore:` - рутинные задачи (обновление зависимостей, gitignore и т.д.)

### 4. Публикация изменений (push)
```bash
# Отправить изменения на удаленный репозиторий
git push origin master

# Или если работаешь в feature branch:
git push origin <branch-name>
```

### Пример полного workflow после успешного теста:

```bash
# После успешного запуска теста
pytest tests/e2e/test_price_management.py -v  # ✅ тест пройден

# Проверяем изменения
git status

# Добавляем только нужные файлы (без скриншотов)
git add dashboard.py managers/products.py tests/e2e/
git reset HEAD tests/e2e/screenshots/  # исключаем скриншоты

# Коммит
git commit -m "feat: добавить E2E тесты и исправить API endpoint

- Добавлен E2E тест для обновления цены товара LM-10160
- Исправлен API endpoint в ProductsManager (discounts-prices-api)
- Упрощен UI: удалена дублирующая кнопка отправки"

# Push
git push origin master
```

### Важные замечания

1. **НЕЛЬЗЯ коммитить непроверенный код** - всегда запускать тесты перед коммитом
2. **НЕЛЬЗЯ коммитить секреты** - проверять, что в коммит не попали токены, пароли
3. **Сообщения коммитов должны быть информативными** - описывать ЧТО и ЗАЧЕМ, не только ЧТО
4. **Один коммит = одна логическая задача** - не смешивать разные изменения в одном коммите
5. **Всегда делать push после коммита** - изменения должны быть доступны в удаленном репозитории
