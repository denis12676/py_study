# –¢–µ—Å—Ç—ã - –°—Ç–∞—Ç—É—Å –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### AnalyticsManager (6/6 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- ‚úÖ test_calculate_revenue_uses_forpay - –ü–†–û–í–ï–†–Ø–ï–¢ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –≤—ã—Ä—É—á–∫–∏
- ‚úÖ test_calculate_revenue_no_sales - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ test_calculate_revenue_detailed - –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å –∫–æ–º–∏—Å—Å–∏—è–º–∏
- ‚úÖ test_get_sales_caching - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ test_clear_cache - –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
- ‚úÖ test_get_top_products - –¢–æ–ø —Ç–æ–≤–∞—Ä–æ–≤

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ:

#### 1. conftest.py
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ–∏–∫—Å—Ç—É—Ä–∞ `mock_api` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è HTTP –º–µ—Ç–æ–¥–æ–≤:
```python
@pytest.fixture
def mock_api(wb_config):
    api = Mock(spec=WildberriesAPI)
    api.config = wb_config
    api.get = Mock()
    api.post = Mock()
    api.put = Mock()
    api.delete = Mock()
    api.patch = Mock()
    yield api
```

#### 2. managers.py - calculate_revenue()
–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–æ–≤:
```python
total_revenue = sum(
    float(sale.get("forPay", 0) or 0) 
    for sale in sales 
    if not sale.get("isCancel", False) and not sale.get("isReturn", False)
)
```

#### 3. managers.py - get_top_products()
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `forPay` –≤–º–µ—Å—Ç–æ `totalPrice`
- –§–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –≤–æ–∑–≤—Ä–∞—Ç—ã –∏–∑ —Å—É–º–º—ã –≤—ã—Ä—É—á–∫–∏
- –í—Å–µ –ø—Ä–æ–¥–∞–∂–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ

## ‚ö†Ô∏è –¢—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### ProductsManager, AdvertisingManager, OrdersManager
–≠—Ç–∏ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å —Ñ–∏–∫—Å—Ç—É—Ä–∞–º–∏ –º–æ–∫–æ–≤. –ù—É–∂–Ω–æ:
1. –û–±–Ω–æ–≤–∏—Ç—å conftest.py –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è —ç—Ç–∏—Ö –∫–ª–∞—Å—Å–æ–≤
2. –ò–ª–∏ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—É—â–∏–º–∏ —Ñ–∏–∫—Å—Ç—É—Ä–∞–º–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–∏–∑–∫–∏–π
–≠—Ç–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –≤—ã—Ä—É—á–∫–∏).

## üéØ –ö–ª—é—á–µ–≤–æ–π —Ç–µ—Å—Ç –¥–ª—è CI/CD

```bash
# –ó–∞–ø—É—Å–∫–∞—Ç—å —ç—Ç–æ—Ç —Ç–µ—Å—Ç –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º!
pytest tests/test_managers.py::TestAnalyticsManager::test_calculate_revenue_uses_forpay -v
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–µ `forPay` (—Å—É–º–º–∞ –∫ –≤—ã–ø–ª–∞—Ç–µ)
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `totalPrice` (—Ü–µ–Ω–∞ –±–µ–∑ —Å–∫–∏–¥–æ–∫)
- –í–æ–∑–≤—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ —Å—É–º–º—ã –≤—ã—Ä—É—á–∫–∏
- –í—Å–µ –∑–∞–ø–∏—Å–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ

**–ï—Å–ª–∏ —ç—Ç–æ—Ç —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç:**
- –í—ã—Ä—É—á–∫–∞ –±—É–¥–µ—Ç –∑–∞–≤—ã—à–µ–Ω–∞
- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏
- –ù—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å!

## üìä –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å

```
AnalyticsManager:    6/6  ‚úÖ (100%)
ProductsManager:     0/5  ‚ö†Ô∏è  (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–∫—Å—Ç—É—Ä)
AdvertisingManager:  0/9  ‚ö†Ô∏è  (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–∫—Å—Ç—É—Ä) 
OrdersManager:       0/6  ‚ö†Ô∏è  (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–∫—Å—Ç—É—Ä)
-----------------------------------
–í—Å–µ–≥–æ:              6/26 ‚úÖ (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç)
```

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `test_calculate_revenue_uses_forpay` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
2. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ - –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –≤–µ—Å—å `TestAnalyticsManager`
3. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∫–∞ (–æ–Ω–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã)

### –î–ª—è CI/CD:
```yaml
- name: Run critical tests
  run: |
    pytest tests/test_managers.py::TestAnalyticsManager -v
    pytest tests/test_wb_client.py -v
```

## üí° –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—á–∏–Ω–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã:

1. **–ü—Ä–æ–¥—É–∫—Ç—ã (ProductsManager)**
   - –ù—É–∂–Ω–æ –º–æ–∫–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã API: `api.post()`, `api.get()`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å endpoint'–æ–≤

2. **–†–µ–∫–ª–∞–º–∞ (AdvertisingManager)**
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –º–æ–∫–∏—Ä–æ–≤–∞—Ç—å HTTP –º–µ—Ç–æ–¥—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∫–∞–º–ø–∞–Ω–∏–π

3. **–ó–∞–∫–∞–∑—ã (OrdersManager)**
   - –ú–æ–∫–∏—Ä–æ–≤–∞—Ç—å API –≤—ã–∑–æ–≤—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

**–ù–æ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã!**
